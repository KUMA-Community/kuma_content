# Пакет контента для Linux Sigma
Правила корреляции, входящие в пакет:
|Название                                                            |Механизм обнаружения                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |Источник событий           |Тактика MITRE                |Техника MITRE                                                                                                     |Реализация                                                                                                                                                                    |Change log|Дата последнего изменения|Версия KUMA|
|--------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------|-----------------------------|------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------|-------------------------|-----------|
|P220;Linux/SIGMA;Сжатие данных                                      |An adversary may compress data (e.g.  sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network. https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_data_compressed.yml                                                                                                                                                                                                                                                                                                                                        |Unix -> EXECVE             |TA0010 (Exfiltration)        |T1560.001 (Archive Collected Data: Archive via Utility)                                                           |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P221;Linux/SIGMA;Копирование или ссылка на файл Passwd/Shadow       |Detects when the file "passwd" or "shadow" is copied from tmp path  Detects suspicious command lines that look as if they would create symbolic links to /etc/passwd                                                                                                                                                                                                                                                                                                                                                                                                                                                         |Unix -> Passwd/Shadow      |TA0006 (Credential Access)   |T1552.001	(Credentials in Files)                                                                                  |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |21.11.2023               |2.1.1.73   |
|P222;Linux/SIGMA;Кейлоггинг с помощью Pam.d                         |Detect attempt to enable auditing of TTY input                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |Unix -> PATH, TTY, USER_TTY|TA0006 (Credential Access)   |T1056.001	(Keylogging)                                                                                            |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |21.11.2023               |2.1.1.73   |
|P223;Linux/SIGMA;Изменение параметров CPU (Возможный майнинг)       |Detects command line parameter very often used with coin miners                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |Unix -> EXECVE             |TA0004 (Privilege Escalation)|T1068	(Exploitation for Privilege Escalation)                                                                     |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |21.11.2023               |2.1.1.73   |
|P224;Linux/SIGMA;Возможный веб-шелл                                 |Detects possible command execution by web application/web shell                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |Unix -> SYSCALL            |TA0003 (Persistence)         |T1505.003	(Web Shell)                                                                                             |Для работы правила требуется настройка политики auditd в соответствии с рекомендацией: https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_web_rce.yml |          |21.11.2023               |2.1.1.73   |
|P225;Linux/SIGMA;Подозрительная выгрузка                            |Detects a suspicious curl process start the adds a file to a web request.  Detects an executable accessing an ngrok tunneling endpoint, which could be a sign of forbidden exfiltration of data exfiltration by malicious actors.  Detects attempts to post the file with the usage of wget utility. The adversary can bypass the permission restriction with the misconfigured sudo permission for wget utility which could allow them to read files like /etc/shadow.                                                                                                                                                      |Unix -> EXECVE, SYSCALL    |TA0010 (Exfiltration)        |T1567	(Exfiltration Over Web Service)                                                                             |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |21.11.2023               |2.1.1.73   |
|P226;Linux/SIGMA;Разведка системы                                   |Detects system information discovery commands                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |Unix -> PATH, EXECVE       |TA0007 (Discovery)           |T1082	(System Information Discovery)                                                                              |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |21.11.2023               |2.1.1.73   |
|P227;Linux/SIGMA;Перенаправление портов с iptables                  |All TCP traffic on particular port from attacker is routed to different port. ex. '/sbin/iptables -t nat -D PREROUTING -p tcp -s 192.168.1.1 --dport 22 -j REDIRECT --to-ports 42392' The traffic looks like encrypted SSH communications going to TCP port 22  but in reality is being directed to the shell port once it hits the iptables rule for the attacker host only. https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_bpfdoor_port_redirect.yml                                                                                                                                           |Unix -> EXECVE             |TA0005 (Defense Evasion)     |T1562.004 (Impair Defenses: Disable or Modify System Firewall)                                                    |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P228;Linux/SIGMA;Изменение параметров аудита                        |Detect changes in auditd configuration files https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_auditing_config_change.yml                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |Unix -> PATH               |TA0005 (Defense Evasion)     |T1562.006 (Indicator Blocking)                                                                                    |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P229;Linux/SIGMA;Обнаружение BPFDoor по специфичным файлам          |Detects BPFDoor .lock and .pid files access in temporary file storage facility https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_bpfdoor_file_accessed.yml                                                                                                                                                                                                                                                                                                                                                                                                                                          |Unix -> PATH               |TA0002 (Execution)           |T1059 (Command and Scripting Interpreter)                                                                         |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P230;Linux/SIGMA;Заполнение данными файлов для маскирования         |Adversaries may use binary padding to add junk data and change the on-disk representation of malware. This rule detect using dd and truncate to add a junk data to file. https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_binary_padding.yml                                                                                                                                                                                                                                                                                                                                                       |Unix -> EXECVE             |TA0005 (Defense Evasion)     |T1027.001 (Obfuscated Files or Information: Binary Padding)                                                       |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P231;Linux/SIGMA;Загрузка модулей ядра командой insmod              |Detects loading of kernel modules with insmod command. Loadable Kernel Modules (LKMs) are pieces of code that can be loaded and unloaded into the kernel upon demand. Adversaries may use LKMs to obtain persistence within the system or elevate the privileges. https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_load_module_insmod.yml                                                                                                                                                                                                                                                          |Unix -> EXECVE             |TA0003 (Persistence)         |T1547.006 (Boot or Logon Autostart Execution: Kernel Modules and Extensions)                                      |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P232;Linux/SIGMA;Подозрительные команды                             |Detects relevant commands often related to malware or hacking activity https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_susp_cmds.yml                                                                                                                                                                                                                                                                                                                                                                                                                                                              |Unix -> EXECVE             |TA0002 (Execution)           |T1059.004 (Command and Scripting Interpreter: Unix Shell)                                                         |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P233;Linux/SIGMA;Создание нового пользователя (ADD_USER)            |Detects the creation of a new user account. Such accounts may be used for persistence that do not require persistent remote access tools to be deployed on the system. https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_create_account.yml                                                                                                                                                                                                                                                                                                                                                         |Unix -> ADD_USER           |TA0003 (Persistence)         |T1136.001 (Create Account: Local Account)                                                                         |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P234;Linux/SIGMA;Создание нового пользователя (SYSCALL)             |Detects the creation of a new user account. Such accounts may be used for persistence that do not require persistent remote access tools to be deployed on the system. https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_create_account.yml                                                                                                                                                                                                                                                                                                                                                         | Unix -> EXECVE            |TA0003 (Persistence)         |T1136.001 (Create Account: Local Account)                                                                         |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P235;Linux/SIGMA;Поиск учетных данных в файлах                      |Detecting attempts to extract passwords with grep https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_find_cred_in_files.yml                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |Unix -> EXECVE             |TA0006 (Credential Access)   |T1552.001 (Unsecured Credentials: Credentials In Files)                                                           |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P236;Linux/SIGMA;Выгрузка с помощью wget                            |Detects attempts to post the file with the usage of wget utility. The adversary can bypass the permission restriction with the misconfigured sudo permission for wget utility which could allow them to read files like /etc/shadow. https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_data_exfil_wget.yml                                                                                                                                                                                                                                                                                          |Unix -> EXECVE             |TA0010 (Exfiltration)        |T1048.003 (Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol)                 |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P237;Linux/SIGMA;Остановка системного МЭ                            |Detects disabling of system firewalls which could be used by adversaries to bypass controls that limit usage of the network. https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_disable_system_firewall.yml                                                                                                                                                                                                                                                                                                                                                                                          |Unix -> SERVICE_STOP       |TA0005 (Defense Evasion)     |T1562.004 (Impair Defenses: Disable or Modify System Firewall)                                                    |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P238;Linux/SIGMA;Изменение атрибутов времени файла                  |Detect file time attribute change to hide new or changes to existing files. https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_change_file_time_attr.yml                                                                                                                                                                                                                                                                                                                                                                                                                                             |Unix -> EXECVE             |TA0005 (Defense Evasion)     |T1070.006 (Indicator Removal: Timestomp)                                                                          |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P239;Linux/SIGMA;Изменение разрешений папки/файла                   |Detects file and folder permission changes. https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_file_or_folder_permissions.yml                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |Unix -> EXECVE             |TA0005 (Defense Evasion)     |T1222.002 (File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification)|Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P240;Linux/SIGMA;Поиск файлов с setuid/setgid                       |Detects attempts to discover the files with setuid/setgid capability on them. That would allow adversary to escalate their privileges. https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_capabilities_discovery.yml                                                                                                                                                                                                                                                                                                                                                                                 |Unix -> EXECVE             |TA0009 (Collection)          |T1548 (Abuse Elevation Control Mechanism)                                                                         |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P241;Linux/SIGMA;Поиск сетевых служб                                |Detects enumeration of local or remote network services. https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_network_service_scanning.yml                                                                                                                                                                                                                                                                                                                                                                                                                                                             |Unix -> EXECVE             |TA0007 (Discovery)           |T1046 (Network Service Discovery)                                                                                 |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P242;Linux/SIGMA;Изменение конфигураций аудита системы              |Detect changes of syslog daemons configuration files https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_logging_config_change.yml                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |Unix -> PATH               |TA0005 (Defense Evasion)     |T1562.006 (Impair Defenses: Indicator Blocking)                                                                   |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P243;Linux/SIGMA;Маскирование файла под crond процесс               |Masquerading occurs when the name or location of an executable  legitimate or malicious  is manipulated or abused for the sake of evading defenses and observation. Several different variations of this technique have been observed. https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_masquerading_crond.yml                                                                                                                                                                                                                                                                                     |Unix -> EXECVE             |TA0005 (Defense Evasion)     |T1036.003 (Masquerading: Rename System Utilities)                                                                 |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P244;Linux/SIGMA;Модификация ld.so.preload (инъекция в процесс)     |Identifies modification of ld.so.preload for shared object injection. This technique is used by attackers to load arbitrary code into processes. https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_ld_so_preload_mod.yml                                                                                                                                                                                                                                                                                                                                                                            |Unix -> PATH               |TA0005 (Defense Evasion)     |T1574.006 (Hijack Execution Flow: Dynamic Linker Hijacking)                                                       |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P245;Linux/SIGMA;Удаление правил МЭ                                 |Detects the removal of system firewall rules. Adversaries may only delete or modify a specific system firewall rule to bypass controls limiting network usage or access. Detection rules that match only on the disabling of firewalls will miss this. https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_modify_system_firewall.yml                                                                                                                                                                                                                                                                 |Unix -> EXECVE             |TA0005 (Defense Evasion)     |T1562.004 (Impair Defenses: Disable or Modify System Firewall)                                                    |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P246;Linux/SIGMA;Прослушивание сетевого трафика                     |Network sniffing refers to using the network interface on a system to monitor or capture information sent over a wired or wireless connection. An adversary may place a network interface into promiscuous mode to passively access data in transit over the network  or use span ports to capture a larger amount of data. https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_network_sniffing.yml                                                                                                                                                                                                  |Unix -> EXECVE             |TA0007 (Discovery)           |T1040 (Network Sniffing)                                                                                          |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P247;Linux/SIGMA;Перезапись файла (стирание)                        |Detects overwriting (effectively wiping/deleting) of a file. https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_dd_delete_file.yml                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |Unix -> EXECVE             |TA0040 (Impact)              |T1485 (Data Destruction)                                                                                          |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P248;Linux/SIGMA;Изучение парольных политик (EXECVE)                |Detects password policy discovery commands https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_password_policy_discovery.yml                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |Unix -> EXECVE             |TA0007 (Discovery)           |T1201 (Password Policy Discovery)                                                                                 |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P249;Linux/SIGMA;Изучение парольных политик (PATH)                  |Detects password policy discovery commands https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_password_policy_discovery.yml                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |Unix -> PATH               |TA0007 (Discovery)           |T1201 (Password Policy Discovery)                                                                                 |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P250;Linux/SIGMA;Исполнение из подозрительной директории            |Detects program executions in suspicious non-program folders related to malware or hacking activity https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_susp_exe_folders.yml                                                                                                                                                                                                                                                                                                                                                                                                                          |Unix -> EXECVE             |TA0042 (Resource Development)|T1584 (Compromise Infrastructure)                                                                                 |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P251;Linux/SIGMA;Удаление неизменяемого атрибута файла              |Detects removing immutable file attribute https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_chattr_immutable_removal.yml                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |Unix -> EXECVE             |TA0005 (Defense Evasion)     |T1222.002 (File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification)|Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P252;Linux/SIGMA;Разделение файла на части (возможная эксфильтрация)|Detection use of the command "split" to split files into parts and possible transfer. https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_split_file_into_pieces.yml                                                                                                                                                                                                                                                                                                                                                                                                                                  |Unix -> EXECVE             |TA0010 (Exfiltration)        |T1030 (Data Transfer Size Limits)                                                                                 |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P253;Linux/SIGMA;Разархивация из картинки (Стеганография)           |Detects extracting of zip file from image file https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_unzip_hidden_zip_files_steganography.yml                                                                                                                                                                                                                                                                                                                                                                                                                                                           |Unix -> EXECVE             |TA0005 (Defense Evasion)     |T1027.003 (Obfuscated Files or Information: Steganography)                                                        |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P254;Linux/SIGMA;Возможная активность С2                            |!Depends on https://github.com/Neo23x0/auditd Detects suspicious activities as declared by Florian Roth in its 'Best Practice Auditd Configuration'. This includes the detection of the following commands; wget  curl  base64  nc  netcat  ncat  ssh  socat  wireshark  rawshark  rdesktop  nmap. These commands match a few techniques from the tactics "Command and Control"  including not exhaustively the following; Application Layer Protocol (T1071)  Non-Application Layer Protocol (T1095)  Data Encoding (T1132) https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_susp_c2_commands.yml |Unix -> susp_activity      |TA0011 (Command and Control) |T1071 (Application Layer Protocol)                                                                                |Для работы правила требуется настройка политики auditd в соответствии с рекомендацией: https://github.com/Neo23x0/auditd                                                      |          |16.06.2023               |2.1.1.73   |
|P255;Linux/SIGMA;Подозрительная активность с файлом history         |Detects commandline operations on shell history files https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_susp_histfile_operations.yml                                                                                                                                                                                                                                                                                                                                                                                                                                                                |Unix -> EXECVE             |TA0006 (Credential Access)   |T1552.003 (Unsecured Credentials: Bash History)                                                                   |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P256;Linux/SIGMA;Изучение системы или пользователей                 |Adversaries may use the information from System Owner/User Discovery during automated discovery to shape follow-on behaviors  including whether or not the adversary fully infects the target and/or attempts specific actions. https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_user_discovery.yml                                                                                                                                                                                                                                                                                                |Unix -> EXECVE             |TA0007 (Discovery)           |T1033 (System Owner/User Discovery)                                                                               |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P257;Linux/SIGMA;Создание службы systemd                            |Detects a creation of systemd services which could be used by adversaries to execute malicious code. https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_systemd_service_creation.yml                                                                                                                                                                                                                                                                                                                                                                                                                 |Unix -> CREATE             |TA0003 (Persistence)         |T1543.002 (Create or Modify System Process: Systemd Service)                                                      |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
|P258;Linux/SIGMA;Обновление или старт службы                        |Detects a reload or a start of a service. https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_pers_systemd_reload.yml                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |Unix -> EXECVE             |TA0003 (Persistence)         |T1543.002 (Create or Modify System Process: Systemd Service)                                                      |Для работы правила не требуется дополнительных настроек.                                                                                                                      |          |16.06.2023               |2.1.1.73   |
